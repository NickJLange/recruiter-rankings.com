<h1>Admin Dashboard</h1>

<div class="grid">
  <div class="card">
    <h3>Pending reviews</h3>
    <p style="font-size:28px; margin:0;"><%= @pending_count %></p>
    <p><a href="<%= admin_reviews_path(statuses: 'pending') %>">Open queue</a></p>
  </div>
  <div class="card">
    <h3>Flagged reviews</h3>
    <p style="font-size:28px; margin:0;"><%= @flagged_count %></p>
    <p><a href="<%= admin_reviews_path(statuses: 'flagged') %>">Open queue</a></p>
  </div>
  <div class="card">
    <h3>Hidden responses</h3>
    <p style="font-size:28px; margin:0;"><%= @hidden_responses_count %></p>
  </div>
  <div class="card">
    <h3>Submissions last 24h</h3>
    <p style="font-size:28px; margin:0;"><%= @recent_submissions_24h %></p>
  </div>
  <div class="card">
    <h3>Verification backlog</h3>
    <p style="font-size:28px; margin:0;"><%= @verification_backlog %></p>
  </div>
</div>

<h2 style="margin-top:24px;">Recent moderation actions</h2>
<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>When</th>
      <th>Actor</th>
      <th>Action</th>
      <th>Subject</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    <% @recent_actions.each do |a| %>
      <tr>
        <td><%= a.id %></td>
        <td><%= a.created_at.strftime('%Y-%m-%d %H:%M') %></td>
        <td><%= a.actor&.id || 'â€”' %></td>
        <td><%= a.action %></td>
        <td><%= "#{a.subject_type}##{a.subject_id}" %></td>
        <td style="max-width:420px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><%= a.notes %></td>
      </tr>
    <% end %>
  </tbody>
</table>

